{% extends 'base.html' %}
{% load static %}
{% block title %}Index{% endblock %}
{% block content_heading %}
<h3>Тендеры</h3>
{% endblock %}
{% block content %}
<form method="post" enctype="multipart/form-data" class="row g-3">
    {% csrf_token %}
    <div class="col-auto">
        <input class="form-control" type="file" name="excel_file">
    </div>
    <div class="col-auto">
        <button type="submit" class="btn btn-outline-dark mb-3">Загрузить</button>
    </div>
</form>
{% if messages %}
{% for message in messages %}
{% if message.tags == "success" %}
<p style="color: green">{{ message }}</p>
{% else %}
<p style="color: red">{{ message }}</p>
{% endif %}
{% endfor %}
{% endif %}
{% endblock %}
{% block table %}
{% if tenders %}
<table class="table table-bordered mt-3" id="tenderTable">
    <thead class="table-primary">
    <tr>
        <th scope="col">№ лота</th>
        <th scope="col">Учреждение</th>
        <th scope="col">Наименование</th>
        <th scope="col">Цена за единицу</th>
        <th scope="col">Количество</th>
        <th scope="col">Плановая сумма</th>
        <th scope="col">Срок поставки</th>
        <th scope="col">Наименование предлагаемого товара</th>
        <th scope="col">Поставщик</th>
        <th scope="col">Цена без скидки</th>
        <th scope="col">% скидка от поставщика</th>
        <th scope="col">Цена со скидкой</th>
        <th scope="col">НДС</th>
        <th scope="col">Примечание</th>
        <th scope="col">Менеджер</th>
        <th scope="col">Цена закупа</th>
        <th scope="col">Общая информация</th>
        <th scope="col">Дата</th>
        <th scope="col">Крайний срок</th>
        <th scope="col">Вид закупа</th>
        <th scope="col">№/ссылка на бумажное объявление</th>
        <th scope="col">Ссылка на эл.лот (формируется автоматически)</th>
        <th scope="col">Коэфф. прибыли</th>
        <th scope="col">Коэфф. доставки</th>
        <th scope="col">Цена закупа за ед.</th>
        <th scope="col">Цена подачи за ед.</th>
        <th scope="col">Цена бюджета за ед.</th>
        <th scope="col">Общая прибыль с проекта</th>
        <th scope="col">Общая сумма закупа</th>
        <th scope="col">Общая сумма договора</th>
        <th scope="col">Выигрыщная цена</th>
        <th scope="col">Текст для КП</th>
        <th scope="col">Статус объявления</th>
        <th scope="col">Действие</th>
    </tr>
    </thead>
    <tbody>
    {% for tender in tenders %}
    <tr data-tender-id="{{ tender.id }}">
        <td data-field="lot" class="modal-trigger"
            data-lot="{{ tender.lot }}"
            data-company="{{ tender.company }}"
            data-name="{{ tender.name }}"
            data-additional-info="{{ tender.additional_info }}"
            data-price-per-unit="{{ tender.price_per_unit }}"
            data-quantity="{{ tender.quantity }}"
            data-measure-unit="{{ tender.measure_unit }}"
            data-planned-amount="{{ tender.planned_amount }}"
            data-delivery-deadline="{{ tender.delivery_deadline }}"
            data-proposed-product-name="{{ tender.proposed_product_name }}"
            data-supplier="{{ tender.supplier }}"
            data-supplier-discount="{{ tender.supplier_discount }}"
            data-vat="{{ tender.vat }}"
            data-note="{{ tender.note }}"
            data-manager="{{ tender.manager }}"
            data-purchase-price="{{ tender.purchase_price }}"
            data-overall-info="{{ tender.overall_info }}"
            data-date="{{ tender.date }}"
            data-deadline="{{ tender.deadline }}"
            data-procurement-type="{{ tender.procurement_type }}"
            data-paper-ad-link="{{ tender.paper_ad_link }}"
            data-lot-link="{{ tender.lot_link }}"
            data-profit-rate="{{ tender.profit_rate }}"
            data-delivery-rate="{{ tender.delivery_rate }}"
            data-purchase-price-per-unit="{{ tender.purchase_price_per_unit }}"
            data-bidding-price-per-unit="{{ tender.bidding_price_per_unit }}"
            data-budget-price-per-unit="{{ tender.budget_price_per_unit }}"
            data-overall-profit="{{ tender.overall_profit }}"
            data-overall-purchase-amount="{{ tender.overall_purchase_amount }}"
            data-overall-contract-amount="{{ tender.overall_contract_amount }}"
            data-winning-price="{{ tender.winning_price }}"
            data-commercial-offer-text="{{ tender.commercial_offer_text }}"
            data-status="{{ tender.status }}"
        >{{ tender.lot }}
        </td>
        <td data-field="company">{{ tender.company }}</td>
        <td data-field="name">{{ tender.name }}</td>
        <td data-field="price_per_unit">{{ tender.price_per_unit }}</td>
        <td data-field="quantity">{{ tender.quantity }}</td>
        <td data-field="planned_amount">{{ tender.planned_amount }}</td>
        <td data-field="delivery_deadline">{{ tender.delivery_deadline }}</td>
        <td data-field="proposed_product_name" class="modal-provider-name">
            <button type="button" class="btn btn-primary" style="margin-left: 7px" data-toggle="modal"
                    data-target="#myCustomModal" data-product-name="Product 2">Подобрать
            </button>
        </td>


        <td data-field="supplier">{{ tender.supplier }}</td>
        <td data-field="price_without_discount">{{ tender.price_withou_discount }}</td>
        <td data-field="supplier_discount">{{ tender.supplier_discount }}</td>
        <td data-field="price_with_discount">{{ tender.price_wit_discount }}</td>
        <td data-field="vat">{{ tender.vat }}</td>
        <td data-field="note">{{ tender.note }}</td>
        <td data-field="manager">{{ tender.manager }}</td>
        <td data-field="purchase_price">{{ tender.purchase_price }}</td>
        <td data-field="overall_info">{{ tender.overall_info }}</td>
        <td data-field="date">{{ tender.date }}</td>
        <td data-field="deadline">{{ tender.deadline }}</td>
        <td data-field="procurement_type">{{ tender.procurement_type }}</td>
        <td data-field="paper_ad_link">{{ tender.paper_ad_link }}</td>
        <td data-field="lot_link">{{ tender.lot_link }}</td>
        <td data-field="profit_rate">{{ tender.profit_rate }}</td>
        <td data-field="delivery_rate">{{ tender.delivery_rate }}</td>
        <td data-field="purchase_price_per_unit">{{ tender.purchase_price_per_unit }}</td>
        <td data-field="bidding_price_per_unit">{{ tender.bidding_price_per_unit }}</td>
        <td data-field="budget_price_per_unit">{{ tender.budget_price_per_unit }}</td>
        <td data-field="overall_profit">{{ tender.overall_profit }}</td>
        <td data-field="overall_purchase_amount">{{ tender.overall_purchase_amount }}</td>
        <td data-field="overall_contract_amount">{{ tender.overall_contract_amount }}</td>
        <td data-field="winning_price">{{ tender.winning_price }}</td>
        <td data-field="commercial_offer_text">{{ tender.commercial_offer_text }}</td>
        <td data-field="status">{{ tender.status }}</td>
        <td>
            <button class="btn btn-sm btn-primary edit-tender">Редактировать</button>
            <button class="btn btn-sm btn-success save-tender" style="display: none;">Сохранить</button>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% include 'partial/partial.html' %}
{% include 'partial/partial_2.html' %}
{% else %}
<p>Объявления не добавлены</p>
{% endif %}
{% endblock %}

